#!/usr/bin/env bash
# -*- coding: utf-8 -*-

__install_nerd_fonts() {
	pushd /tmp || return 1
	mkdir -p "$HOME/.local/share/fonts"
	for font in "$@"; do
		local outdir="$HOME/.local/share/fonts/$font Nerd Font"
		wget -c "https://github.com/ryanoasis/nerd-fonts/releases/latest/download/$font.zip"
		mkdir -p "$outdir"
		pushd "$outdir" || return 1
		7z x "/tmp/$font.zip" -aoa
		popd || return 1
	done
	popd || return 1

	# Remove unused fonts and install fonts system-wide for all users
	pushd ~/.local/share/fonts || return 1
	sudo mkdir -p /usr/local/share/fonts
	find . -type f | grep -Ei "\bWindows Compatible.ttf$" | xargs -I {} rm -rf {}
	for font in "$@"; do
		sudo mv "$font Nerd Font" /usr/local/share/fonts
	done
	popd || return 1

	# Refresh the cache
	fc-cache -fvr
}

##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
## Public functions
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################

install_all_fonts() {
	__install_nerd_fonts "Hack" "JetBrainsMono" "CascadiaCode" "IBMPlexMono" "LiberationMono" "Meslo" "Noto" "Ubuntu" "UbuntuMono" "SourceCodePro"
	sudo wget "https://github.com/microsoft/vscode-codicons/raw/main/dist/codicon.ttf" -O /usr/share/fonts/codicon.ttf
}
